<script>
	import Codemirror from "./codemirror/Codemirror.html"

	let text
	let output

	function sendText(){
		fetch('/python', {
            method: 'POST',
            headers: {
				'Accept': 'application/json',
				'Content-Type': 'application/json',
				'x-csrf-token': window.csrfToken
			},
            body: JSON.stringify({ command: text })
        })
        .then(resp => resp.json())
        .then(s => {
			console.log(s)
			output = s.stdout || s.stderr
		})
	}

	function on_change(cm){
		text = cm.getValue()
	}

</script>

<style>
	h1 {
		color: black;
	}

	textarea {
		width: 50vw;
		height: 25vh;
	}

</style>

<div>
	<div>
		<Codemirror mode="python" on_change={on_change}></Codemirror>
		<textarea bind:value={output}></textarea>
	</div>
	<button on:click={sendText}>Send me</button>
</div>
